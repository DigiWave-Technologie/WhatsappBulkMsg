{
  "info": {
    "name": "WhatsApp Official Campaign Test",
    "_postman_id": "whatsapp-official-campaign-test-001",
    "description": "Test WhatsApp Official campaign: login, create, and run campaign for recipient 918347012320.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Login as Super Admin",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"username\":\"superadmin1\",\"password\":\"SuperAdmin@123\"}"
        },
        "url": {
          "raw": "http://localhost:3000/api/auth/login",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3000",
          "path": ["api", "auth", "login"]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Save token to environment variable",
              "if (pm.response.code === 200) {",
              "  var json = pm.response.json();",
              "  pm.environment.set(\"token\", json.data.token);",
              "  pm.environment.set(\"userId\", json.data.user._id);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Create WhatsApp Official Campaign (Manual Recipients)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test WhatsApp Official Campaign\",\n  \"type\": \"WHATSAPP_OFFICIAL\",\n  \"sendType\": \"manual\",\n  \"recipients\": [\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\",\n    \"918347012320\"\n  ],\n  \"countries\": [\"IN\"],\n  \"messageLimit\": 10,\n  \"batchSize\": 10,\n  \"intervalTime\": 5,\n  \"message\": { \"text\": \"Hello, this is a test WhatsApp Official campaign!\" },\n  \"metaApiData\": {\n    \"phoneNumberId\": \"{{phoneNumberId}}\"\n  }\n}"
        },
        "url": {
          "raw": "http://localhost:3000/api/campaigns",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3000",
          "path": ["api", "campaigns"]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Save campaignId to environment variable",
              "if (pm.response.code === 201) {",
              "  var json = pm.response.json();",
              "  pm.environment.set(\"campaignId\", json.data._id);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Start Campaign Immediately",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": {
          "raw": "http://localhost:3000/api/campaigns/{{campaignId}}/start",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3000",
          "path": ["api", "campaigns", "{{campaignId}}", "start"]
        }
      },
      "response": []
    }
  ]
} 